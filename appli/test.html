<!doctype html>
<html lang="fr">
  <head>
    <!--Encodage-->
    <meta title="Visualisation des données extraites des annuaires du commerce parisien">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--JQuery-->
    <script src="./libs/jquery-3.6.1.min.js"></script>
    <script src="./libs/jquery.geo.min.js"></script>
    <!--Slider-->
    <script src="./libs/wnumb-1.2.0/wNumb.min.js"></script>
    <link rel="stylesheet" href="./libs/noUiSlider/nouislider.min.css" />
   <script src="./libs/noUiSlider/nouislider.min.js"></script>
    <!--Leaflet-->
    <script>L_PREFER_CANVAS=true;</script>
    <link rel="stylesheet" href="./libs/leaflet/leaflet.css" />
    <script src="./libs/leaflet/leaflet.js"></script>
    <!--Leaflet Full Screen-->
    <link rel="stylesheet" href="./libs/leaflet.fullscreen-master/Control.FullScreen.css"/>
    <script src="./libs/leaflet.fullscreen-master/Control.FullScreen.js"></script>
    <!--Leaflet clusters-->
    <script src="./libs/leaflet.markercluster/leaflet.markercluster.js"></script>
    <link rel="stylesheet" href="./libs/leaflet.markercluster/MarkerCluster.Default.css" />
    <script src="./libs/leaflet-markercluster.placementstrategies.js"></script>
    <!-- Leaflet Control Panel-->
    <link rel="stylesheet" href="./libs/leaflet-panel-layers/src/leaflet-panel-layers.css">
    <script src="./libs/leaflet-panel-layers/src/leaflet-panel-layers.js"></script>
    <!--Leaflet.draw-->
    <script src="./libs/leaflet_draw/src/Leaflet.draw.js"></script>
    <script src="./libs/leaflet_draw/src/Leaflet.Draw.Event.js"></script>
    <link rel="stylesheet" href="./libs/leaflet_draw/src/leaflet.draw.css"/>

    <script src="./libs/leaflet_draw/src/Toolbar.js"></script>
    <script src="./libs/leaflet_draw/src/Tooltip.js"></script>

    <script src="./libs/leaflet_draw/src/ext/GeometryUtil.js"></script>
    <script src="./libs/leaflet_draw/src/ext/LatLngUtil.js"></script>
    <script src="./libs/leaflet_draw/src/ext/LineUtil.Intersect.js"></script>
    <script src="./libs/leaflet_draw/src/ext/Polygon.Intersect.js"></script>
    <script src="./libs/leaflet_draw/src/ext/Polyline.Intersect.js"></script>
    <script src="./libs/leaflet_draw/src/ext/TouchEvents.js"></script>

    <script src="./libs/leaflet_draw/src/draw/DrawToolbar.js"></script>
    <script src="./libs/leaflet_draw/src/draw/handler/Draw.Feature.js"></script>
    <script src="./libs/leaflet_draw/src/draw/handler/Draw.SimpleShape.js"></script>
    <script src="./libs/leaflet_draw/src/draw/handler/Draw.Polyline.js"></script>
    <script src="./libs/leaflet_draw/src/draw/handler/Draw.Marker.js"></script>
    <script src="./libs/leaflet_draw/src/draw/handler/Draw.Circle.js"></script>
    <script src="./libs/leaflet_draw/src/draw/handler/Draw.CircleMarker.js"></script>
    <script src="./libs/leaflet_draw/src/draw/handler/Draw.Polygon.js"></script>
    <script src="./libs/leaflet_draw/src/draw/handler/Draw.Rectangle.js"></script>

    <script src="./libs/leaflet_draw/src/edit/EditToolbar.js"></script>
    <script src="./libs/leaflet_draw/src/edit/handler/EditToolbar.Edit.js"></script>
    <script src="./libs/leaflet_draw/src/edit/handler/EditToolbar.Delete.js"></script>

    <script src="./libs/leaflet_draw/src/Control.Draw.js"></script>

    <script src="./libs/leaflet_draw/src/edit/handler/Edit.Poly.js"></script>
    <script src="./libs/leaflet_draw/src/edit/handler/Edit.SimpleShape.js"></script>
    <script src="./libs/leaflet_draw/src/edit/handler/Edit.Rectangle.js"></script>
    <script src="./libs/leaflet_draw/src/edit/handler/Edit.Marker.js"></script>
    <script src="./libs/leaflet_draw/src/edit/handler/Edit.CircleMarker.js"></script>
    <script src="./libs/leaflet_draw/src/edit/handler/Edit.Circle.js"></script>

    <!--Timeline JS-->
    <link title="timeline-styles" rel="stylesheet" href="./libs/timelineJS/timeline.css">
    <script src="./libs/timelineJS/timeline.js"></script> 
    <!--Plotly JS-->
    <script src="./libs/plotly-latest.min.js"></script>

    <!--Style-->
    <link rel="stylesheet" href="libs/w3.css">
    <link rel="stylesheet" href="style.css">
    <style>
        #map { height: 400px; }
    </style>
</head>
<body>

<div id="map"></div>
<script>
    var map = L.map('map').setView([51.505, -0.09], 13);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: 'Map data © <a href="https://openstreetmap.org">OpenStreetMap</a> contributors'
    }).addTo(map);

    // Sample GeoJSON data with 4 properties
    var myGeoJSON = {
        "type": "FeatureCollection",
        "features": [
            {
                "type": "Feature",
                "properties": {
                    "name": "Point 1",
                    "property1": "Value 1",
                    "property2": "Value 2",
                    "property3": "Value 3"
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [51.5, -0.09]
                }
            },
            {
                "type": "Feature",
                "properties": {
                    "name": "Point 2",
                    "property1": "Value 1",
                    "property2": "Value 2",
                    "property3": "Value 3"
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [51.51, -0.1]
                }
            }
        ]
    };

    var markers = L.markerClusterGroup().addTo(map);

    L.geoJSON(myGeoJSON, {
        pointToLayer: function (feature, latlng) {
            return L.circleMarker(latlng);
        },
        onEachFeature: function (feature, layer) {
            layer.bindPopup('<p><b>Name:</b> ' + feature.properties.name + '</p><p><a href="#" onclick="openPopupForPoint(' + feature.geometry.coordinates[1] + ', ' + feature.geometry.coordinates[0] + ')">View Details</a></p>');
            markers.addLayer(layer);
        }
    });

    markers.on('clusterclick', function (a) {
        var childMarkers = a.layer.getAllChildMarkers();
        var tableContent = '<table>';
        childMarkers.forEach(function (marker) {
            tableContent += '<tr><td><a href="#" onclick="openPopupForPoint(' + marker._latlng.lat + ', ' + marker._latlng.lng + ')">View Details</a></td><td>' + marker._latlng + '</td></tr>';
        });
        tableContent += '</table>';
        var popup = L.popup().setLatLng(a.layer.getLatLng()).setContent(tableContent).openOn(map);
    });

    function openPopupForPoint(lat, lng) {
        var content = 'Latitude: ' + lat + '<br>Longitude: ' + lng;
        L.popup().setLatLng([lat, lng]).setContent(content).openOn(map);
    }

</script>
</body>
</html>